<?xml version='1.0' encoding='UTF-8'?>
<document>
  <properties>
    <title>In Fess make Apache Solr based search server-introduction</title>
    <author>Shinsuke Sugaya</author>
  </properties>
  <body>
    <section name='Introduction'>
    <p>
      Document management is increasing daily, is expected to effectively manage their documents.
      More managed document, with specific information from its difficult to continue.
    Include implementing full-text search server able to search through vast as the solution.</p>
    <p>
      Fess is a easy deployment, Java-based open-source full-text search server.
      The search engine part of the Fess by using Apache Solr.
      Is a very powerful search engine called SOLR index can be the 200 million document.
      On the other hand, may need to implement in your own crawler parts, such as when trying to build in the Apache Solr search system.
    You can use S2Robot Fess offers from the Seasar Project crawler parts, collect Web or file system on various types of documents to search.</p>
    <p>
      Therefore, this article introduces about building a search server by Fess.
    </p>

    </section>
    <section name='Intended audience'>
    <ul>
      <li>Those who want to build search system</li>
      <li>Those who observed to add search functionality into existing systems</li>
      <li>Those who are interested in Apache Solr</li>
    </ul>

    </section>
    <section name='Required environment'>
    <p>
      Regarding the content of this article in the following environment and behavior verification.
    </p>
    <ul>
      <li>
        Windows 7 (Service Pack1)
      </li>
      <li>
        JDK 1.7.0_21
      </li>
    </ul>

    </section>
    <section name='And Fess'>
    <p>
      Fess is a open source Web and file system using the full text search system. The SourceForge.jp<a href='http://fess.codelibs.org/ja/'>Fess sites</a>From the provided in the Apache license.
    </p>

    <subsection name='Fess features'>

    <h4>
      Java-based search system
    </h4>
    <p>
      Fess is as in the following figure, has been built using various open source products.
    </p>
    <div class='centerimg'>
      <div class='caption'>Fess structure</div>
      <div class='img'>
        <a href='/images/ja/article/1/architecture.png' rel='lightbox'><img alt='Fess structure' src='/images/ja/article/1/architecture.png'/></a>
      </div>
    </div>
    <p>
      A Fess and Solr war file is deployed to the Tomcat distribution.
      War file of the Fess offers search and management screens.
      The Fess as a development framework Seasar2, SAStruts employs in the presentation layer.
    So, by modifying the JSP if you want to customize, such as screen easy customization is possible.</p>
    <p>
      Also using the built-in database H2Database to save settings and crawl data, is accessed by using o/r Mapper DBFlute.
      S9chronos is used to perform a crawl in the time specified in the Fess, scheduling framework provided by the Seasar project.
    SOLR and S2Robot are discussed.</p>
    <p>
      Fess was constructed as a Java-based system, so any platform can be performed.
    Provides a UI to easily set from the Web browser settings.</p>

    <h4>
      As a search engine using Apache Solr
    </h4>
    <p>
      Apache Solr is an enterprise search server based on Lucene, is available from the Apache Software Foundation.
      Roundness that characterized the support such as faceted search, search result highlighting, multiple output formats.
      Also in the Solr server configuration depends on the number of documents that can be searched for, and several hundred million documents, you can scale out to large scale site search server.
    Said to search engine usage and many in Japan, has been in.</p>
    <p>
      Fess uses Apache Solr to search engines.
      Distributed in the distribution of the Fess in the Solr, but cut out Fess Solr server to another server that is available.
      Also, multiple Solr Server manages the Fess as a group, form a redundant configuration is possible.
    Design can take advantage of scalability in this way with SOLR in Fess;</p>

    <h4>
      Available as a crawling engine S2Robot
    </h4>
    <p>
      S9robot is the krolaframework provided by the Seasar project.
      S2Robot can collect touring the document to the documents on the Web or on the file system.
      It is possible to also document collection in multiple threads simultaneously multiple documents efficiently treating.
    Also, document can handle HTML, not to mention in numerous formats such as MS Office system files, such as Word and Excel, zip archive files, images and audio files, including covers (images and audio files, gets a meta-information).</p>
    <p>
      Fess by using S2Robot, touring on the Web and file system documents, collect text information.
      You can can handle S2Robot file format to accommodate even those to be searched.
    Etc to crawl through the S2Robot for parameter it is possible to set from the management UI of the Fess.</p>


    <h4>
      Mobile support
    </h4>
    <p>
      Fess is compatible for viewing on docomo, au and Softbank Mobile phones.
      You can specify when indexing documents to can be viewed in search results with what handsets.
    Book and skip for viewing on your mobile device in the paper, describes the next time.</p>

    </subsection>
    </section>
    <section name='Installation and startup'>
    <p>
      Start the Fess, and describes the steps to do a search.
    You can install and launch in almost similar steps in Mac OS X and Linux provides information intended to be run on Windows XP, but.</p>

    <subsection name='Download and installation'>
    <p>
      <a href='http://sourceforge.jp/projects/fess/releases/'>http://sourceforge.jp/projects/Fess/releases/</a> From the download the latest package.
      The most recent version at the time of writing this article （ 2013 / 06 ） 8.1.0.
    Unzip the download has finished, in any directory.</p>
    <div class='centerimg'>
      <div class='caption'>Download Fess</div>
      <div class='img'>
        <a href='/images/ja/article/1/fess-download.png' rel='lightbox'><img alt='Download Fess' src='/images/ja/article/1/fess-download.png'/></a>
      </div>
    </div>

    </subsection>
    <subsection name='Launch'>
    <p>
      CATALINA_HOME and JAVA_HOME environment more appropriately, please run the %CATALINA_HOME%\bin\startup.bat.
    For example, if you unzip the fess-8.1.0.zip C:\fess CATALINA_HOME is C:\fess\fess-server-8.1.0.</p>
    <div class='src_frame'>
      <div class='caption'>Launch of the Fess</div>
<pre class='prettyprint'>
C:\fess\fess-Server-8.1.0 &gt; set &quot;JAVA_HOME = C:\Program Files \Java\jdk1.7.0_21&quot; C:\fess\fess-server-8.1.0 &gt; set CATALINA_HOME = C:\fess\fess-server-8.1.0 C:\fess\fess-server-8.1.0 &gt; cd bin C:\fess\fess-server-8.1.0\bin &gt; startup.bat
</pre>
    </div>
    <p>
      In the browser <a href='http://localhost:8080/fess/'>/ http://localhost:8080/Fess</a> The Fess is starting and access the following screen appears, the.
    </p>
    <div class='centerimg'>
      <div class='caption'>Search top screen</div>
      <div class='img'>
        <a href='/images/ja/article/1/top.png' rel='lightbox'><img alt='Search top screen' src='/images/ja/article/1/top.png'/></a>
      </div>
    </div>

    </subsection>
    <subsection name='Stop'>
    <p>
      Please run the shutdown.bat.
    </p>
    <div class='src_frame'>
      <div class='caption'>Stop Fess</div>
<pre class='prettyprint'>
C:\fess\fess-Server-8.1.0\Bin &gt; shutdown.bat
</pre>
    </div>

    </subsection>
    <subsection name='Directory configuration'>
    <p>
      Directory structure looks like this.
    </p>
    <div class='src_frame'>
      <div class='caption'>Directory configuration</div>
<pre class='prettyprint'>
Fess-Server-8.1.0/ |--LICENSE |--NOTICE |--RELEASE-NOTES |--RUNNING.txt |--bin / |--conf / |--extension / |--lib / |--logs / |--solr /-- <strong>SOLR data directory</strong>
|   |--contrib / |   |--core1 / |   | |-- bin/                    --<strong>SOLR executable</strong>
|   | |-- conf/                   --<strong>Place the settings file in SOLR</strong>
|   | |-- data/                   --<strong>Contains the SOLR index</strong>
|   |   &apos;--txlog / |   |--dist / |   &apos;--lib / |--temp / |--webapps / |   |--fess and |   |   |--META-INF / |   |   |--Web-INF / |   |   | |--cachedirs /--<strong>Store for mobile image cache</strong>
|   |   | |--classes /--<strong>Place the classes and settings files</strong>
|   |   | |-- db/                 --<strong>Place the DB data</strong>
|   |   |   |--cmd |   |   |   |--conf / |   |   |   |--lib / |   |   |   |--orig / |   |   | |-- logs/               --<strong>Contains the log files of the Fess</strong>
|   |   | |-- view/               --<strong>Place the JSP UI related</strong>
|   |   |   |--fe.tld |   |   |   |--struts-config.xml |   |   |   |--validator-rules.xml |   |   |   &apos;--web.xml |   | |-- css/                    --<strong>Place the CSS file</strong>
|   | |-- js/                     --<strong>Place the JS file</strong>
|   | |-- images/                 --<strong>Place the image file</strong>
|   |   &apos;--jar / |   |--fess.war | |-- solr/                       --<strong>The SOLR Web apps</strong>
|   |--solr.war |   |--manager / |

&apos;--manager.war &apos;--work /</pre>
    </div>
    <p>
      just below the &quot;fess-server-8.1.0&quot; directory configuration is similar to the Tomcat 7, might be deployed Solr data directory &apos;solr&apos;, &apos;fess.war&apos; and &apos;solr.war.
      Is deployed &apos;fess.war&apos; to &apos;webapps/fess/WEB-INF/view&apos; put JSP file search and management screens.
    Also, if you need to customize the screen CSS file is placed in the &apos;webapps/fess/css&apos;, so edit the files.</p>

    </subsection>
    </section>
    <section name='To search from indexing'>
    <p>
      Also indexed for search in the State immediately after the launch, make a search returned nothing results.
      So, you must first create the index. In this case,<a href='http://fess.codelibs.org/ja/'>http://Fess.codelibs.org/ja/</a> Create index to below, to do a search as an example.
    </p>
    <subsection name='Login to the management page'>
    <p>
      First of all, on Administration page <a href='http://localhost:8080/fess/admin'>http://localhost:8080/Fess/Admin</a> To access, please login.
    By default user name and password are both admin.</p>

    <div class='centerimg'>
      <div class='caption'>Login to the management page</div>
      <div class='img'>
        <a href='/images/ja/article/1/login.png' rel='lightbox'><img alt='Login' src='/images/ja/article/1/login.png'/></a>
      </div>
    </div>

    </subsection>
　  <subsection name='Registration of the crawl'>
    <p>
      Then, register the crawled.
      Because the Web page, select the [Web] from the left of the admin page.
    For anything not registered in the initial state, select Create new.</p>

    <div class='centerimg'>
      <div class='caption'>Select the [new]</div>
      <div class='img'>
        <a href='/images/ja/article/1/web-crawl-conf-1.png' rel='lightbox'><img alt='Create a new' src='/images/ja/article/1/web-crawl-conf-1.png'/></a>
      </div>
    </div>

    <p>
      As a Web crawl settings, this is<a href='http://fess.codelibs.org/ja/'>http://Fess.codelibs.org/ja/</a> That will crawl all the pages below.
    In addition, results are displayed when you search from any PC or mobile phone, and then select all as the browser type.</p>

    <div class='centerimg'>
      <div class='caption'>Web crawl settings</div>
      <div class='img'>
        <a href='/images/ja/article/1/web-crawl-conf-2.png' rel='lightbox'><img alt='Crawl settings' src='/images/ja/article/1/web-crawl-conf-2.png'/></a>
      </div>
    </div>

    <p>
      Then, click the [create] on the confirmation screen that can crawl to register.
    Registration is possible to change from the Edit.</p>

    <div class='centerimg'>
      <div class='caption'>Completing the registration Web crawl settings</div>
      <div class='img'>
        <a href='/images/ja/article/1/web-crawl-conf-3.png' rel='lightbox'><img alt='Crawl settings for registering' src='/images/ja/article/1/web-crawl-conf-3.png'/></a>
      </div>
    </div>

    </subsection>
　  <subsection name='Crawl schedule'>
    <p>
      Set to collect, document, crawl schedules.
    Crawl schedules are set from the menu on the left of the admin page crawl General.</p>
    <p>
      Formatting is similar to the Unix Cron.
      From left, seconds, minutes, time, day, month, represents a day of the week.
    For example, daily 12: If you successfully crawl your 10 am &apos; 0 10 12 * *? &apos; and then I.</p>

    <div class='centerimg'>
      <div class='caption'>Crawl schedule</div>
      <div class='img'>
        <a href='/images/ja/article/1/crawl-schedule-conf.png' rel='lightbox'><img alt='Crawl schedule' src='/images/ja/article/1/crawl-schedule-conf.png'/></a>
      </div>
    </div>

    <p>
      Crawl is started and the index has been created to make from the menu on the left side, the session information that you can.
    Displays the document number when the crawl is complete, the search index size of session information (Web/file).</p>

    <div class='centerimg'>
      <div class='caption'>Check the crawl status of</div>
      <div class='img'>
          <a href='/images/ja/article/1/session-info-1.png' rel='lightbox'><img alt='Check the crawl status of' src='/images/ja/article/1/session-info-1.png'/></a>
      </div>
    </div>

    <div class='centerimg'>
      <div class='caption'>If the crawl is complete example</div>
      <div class='img'>
        <a href='/images/ja/article/1/session-info-2.png' rel='lightbox'><img alt='If the crawl is complete example' src='/images/ja/article/1/session-info-2.png'/></a>
      </div>
    </div>

    </subsection>
　  <subsection name='Search examples'>
    <p>
      Like image below to search crawl after the results are returned.
    </p>

    <div class='centerimg'>
      <div class='caption'>Search example</div>
      <div class='img'>
        <a href='/images/ja/article/1/search-result.png' rel='lightbox'><img alt='Search example' src='/images/ja/article/1/search-result.png'/></a>
      </div>
    </div>

    </subsection>
    </section>
    <section name='Customizing the search screen'>
    <p>
      Here, the most viewed users, search results and search top screen shows how to customize the list screen.
    </p>
    <p>
      Shows how we change the log file name.
    You can change any knowledge of HTML, so if you want to change the design itself described in a simple JSP files.</p>
    <p>
      First of all, find the top screen &apos;webapps/fess/WEB-INF/view/index.jsp&apos; file.
    </p>
    <div class='src_frame'>
      <div class='caption'>Search top screen JSP files</div>
<pre class='prettyprint'>
&lt;%@page pageEncoding=&quot;UTF-8&quot; contentType=&quot;text/html; charset=UTF-8&quot;%&gt;
&lt;html&gt;
&lt;head&gt;
&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot;&gt;
&lt;meta http-equiv=&quot;content-style-type&quot; content=&quot;text/css&quot;&gt;
&lt;meta http-equiv=&quot;content-script-type&quot; content=&quot;text/javascript&quot;&gt;
&lt;title&gt;Fess&lt;/title&gt;
&lt;link href=&quot;${f:url(&apos;/css/style.css&apos;)}&quot; rel=&quot;stylesheet&quot; type=&quot;text/css&quot;&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;div id=&apos;main&apos;&gt;
&lt;s:form action=&quot;search&quot;&gt;
  &lt;table&gt;
    &lt;tbody&gt;
      &lt;tr&gt;
        &lt;td&gt;&lt;img id=&quot;logo&quot; src=&quot;${f:url(&apos;/images/ id=&quot;logo&quot; src=&quot;&quot;&gt;&lt;/img id=&quot;logo&quot; src=&quot;${f:url(&apos;/images/&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/s:form&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;<strong>logo.gif</strong>&apos;)}&quot; alt=&quot;&lt;bean:message key=&quot;labels.search_top_logo_alt&quot;&gt;&lt;/bean:message&gt;&quot; /&gt;
        &lt;td&gt;&lt;div class=&quot;input&quot;&gt;
          &lt;html:text styleclass=&quot;query&quot; property=&quot;query&quot; title=&quot;Search&quot; size=&quot;50&quot; maxlength=&quot;1000&quot;&gt;&lt;/html:text&gt;
          &lt;input class=&quot;btn&quot; type=&quot;submit&quot; value=&quot;&lt;bean:message key=&quot; labels.top.search&quot;/=&quot;&quot;&gt;&quot;name =&quot;search&quot;/ &gt;&lt;/div&gt;&lt;/td&gt;
      
    
  



</pre>
    </div>
    <p>
      Change the file name to change the images that appear on the home screen search &apos;logo.gif&apos; where you want to replace.
    Files placed in the &apos;webapps/fess/images&apos;.</p>
    <p>
      &lt;s:form&gt;And &lt;bean:message&gt;such as a JSP tag.
      For example,&lt;s:form&gt; the actual HTML view when converted to the form tag.
    Detailed description see SAStruts or for JSP sites. &lt;/s:form&gt;&lt;/bean:message&gt;&lt;/s:form&gt;</p>
    <p>
      The search results list screen will be in the &apos;webapps/fess/WEB-INF/view/search.jsp&apos; file.
    </p>
    <div class='src_frame'>      
      <div class='caption'>Search results part of the JSP file list screen</div>
<pre class='prettyprint'>
&lt;div id=&quot;header&quot;&gt;
  &lt;s:form action=&quot;search&quot;&gt;
    &lt;div class=&quot;input&quot;&gt;
      &lt;s:link action=&quot;index&quot; title=&quot;Fess Home&quot;&gt;
        &lt;img class=&quot;logo&quot; src=&quot;${f:url(&apos;/images/ class=&quot;logo&quot; src=&quot;&quot;&gt;&lt;/img class=&quot;logo&quot; src=&quot;${f:url(&apos;/images/&gt;&lt;/s:link&gt;&lt;/div&gt;&lt;/s:form&gt;&lt;/div&gt;<strong>logo-head.gif</strong>&apos;)}&quot; alt=&quot;&lt;bean:message key=&quot;labels.search_header_logo_alt&quot;&gt;&lt;/bean:message&gt;&quot;/&gt;                                 
      &lt;html:text styleclass=&quot;query&quot; property=&quot;query&quot; title=&quot;Search&quot; size=&quot;50&quot; maxlength=&quot;1000&quot;&gt;&lt;/html:text&gt;
      &lt;input class=&quot;btn&quot; type=&quot;submit&quot; value=&quot;&lt;bean:message key=&quot; labels.search&quot;/=&quot;&quot;&gt;&quot;name =&quot;search&quot;/ &gt;
  

</pre>
    </div>
    <p>
      Results of the &apos;logo-head.gif&apos; file name change to change the image that appears at the top of the screen.
    similar to &apos;logo.gif&apos; put in &apos;webapps/fess/images&apos;.</p>
    <p>
      Edit &apos;Style.css&apos; If you want to change the CSS file used in a JSP file located in the &apos;webapps/fess/css&apos;.
    </p>

    </section>
    <section name='Summary'>
    <p>
      About the Fess in the full-text search system, from installation until search and simple customization methods discussed.
      I could introduce you can easily build a search system if you have the Java runtime environment, with no special environment.
    Can be introduced into an existing system site search functionality, such as if you want, so you try.</p>
    <p>
      I want to introduce the next time you support Fess mobile site search feature.
    </p>


    </section>
    <section name='Reference material'>
    <ul>
      <li>
        <a href='http://fess.codelibs.org/ja/'>Fess</a>
      </li>
      <li>
        <a href='http://lucene.apache.org/solr/'>Apache Solr</a>
      </li>
      <li>
        <a href='http://s2robot.sandbox.seasar.org/ja/'>S2Robot</a>
      </li>
      <li>
        <a href='http://sastruts.seasar.org/'>SAStruts</a>
      </li>
      <li>
        <a href='http://dbflute.sandbox.seasar.org/'>DBFlute</a>
      </li>
      <li>
        <a href='http://s2chronos.sandbox.seasar.org/ja/'>S2Chronos</a>
      </li>
    </ul>
    </section>
  </body>
</document>
