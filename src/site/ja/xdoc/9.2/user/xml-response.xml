<?xml version="1.0" encoding="UTF-8"?>
<document>
  <properties>
    <title>XMLによる検索結果</title>
    <author>菅谷 信介</author>
  </properties>
  <body>
    <section name="XML応答による検索">
      <p>Fessの検索結果をXMLにより出力することができます。XMLで出力するためには管理画面のクロール全般の設定でXML応答を有効にしておく必要があります。</p>
      <subsection name="リクエスト">
        <p>XMLにより出力結果を得るためには <code>http://localhost:8080/fess/xml?query=検索語</code> のようなリクエストを送ります。リクエストパラメータについては以下の通りです。</p>
        <table>
          <caption>リクエストパラメータ</caption>
          <tbody>
            <tr>
              <th>query</th>
              <td>検索語。URLエンコードして渡します。</td>
            </tr>
            <tr>
              <th>start</th>
              <td>開始する件数位置。0から始まります。</td>
            </tr>
            <tr>
              <th>num</th>
              <td>表示件数。デフォルトは20件です。100件まで表示できます。</td>
            </tr>
            <tr>
              <th>fields.label</th>
              <td>ラベル値。ラベルを指定する場合に利用します。</td>
            </tr>
          </tbody>
        </table>
      </subsection>
      <subsection name="レスポンス">
        <p>以下のようなレスポンスが返ります。</p>
        <source><![CDATA[
<?xml version="1.0" encoding="UTF-8"?>
<response>
  <version>1</version>
  <status>0</status>
  <query>Fess</query>
  <exec-time>0.64</exec-time>
  <page-size>20</page-size>
  <page-number>1</page-number>
  <record-count>101</record-count>
  <page-count>6</page-count>
  <result>
    <doc>
      <created>2014-05-24T15:13:27.692+0900</created>
      <doc-id>d55275b552da44999cafe118aa8fed62</doc-id>
      <title>Fess&#12398;&#12452;&#12531;...</title>
      <url>http://fess.codelibs.org/ja/setup.html</url>
      <score>0.83177954</score>
      <site>fess.codelibs.org/ja/setup.html</site>
      <filetype-s>html</filetype-s>
      <content-description> &lt;em&gt;fess&lt;/em&gt;...</content-description>
      <digest>&#12458;&#12540;&#12503;&#12531;&#12477;...</digest>
      <host>fess.codelibs.org</host>
      <mimetype>text/html</mimetype>
      <content-length>49702</content-length>
      <boost>1.0</boost>
      <last-modified>2014-05-22T11:09:07.000+0900</last-modified>
      <id>http://fess.codelibs.org/ja/setup.html</id>
      <url-link>http://fess.codelibs.org/ja/setup.html</url-link>
    </doc>
...
  </result>
</response>
]]></source>
        <p>各要素については以下の通りです。</p>
        <table>
          <caption>レスポンス情報</caption>
          <tbody>
            <tr>
              <th>response</th>
              <td>ルート要素。</td>
            </tr>
            <tr>
              <th>version</th>
              <td>フォーマットバージョン。</td>
            </tr>
            <tr>
              <th>status</th>
              <td>レスポンスのステータス。status値は、0:正常、1:検索エラー、2または3:リクエストパラメータエラー、9:サービス停止中、-1:API種別エラーです。</td>
            </tr>
            <tr>
              <th>query</th>
              <td>検索語。</td>
            </tr>
            <tr>
              <th>exec-time</th>
              <td>応答時間。単位は秒。</td>
            </tr>
            <tr>
              <th>page-size</th>
              <td>表示件数。</td>
            </tr>
            <tr>
              <th>page-number</th>
              <td>ページ番号。</td>
            </tr>
            <tr>
              <th>record-count</th>
              <td>検索語に対してヒットした件数。</td>
            </tr>
            <tr>
              <th>page-count</th>
              <td>検索語に対してヒットした件数のページ数。</td>
            </tr>
            <tr>
              <th>result</th>
              <td>検索結果の親要素。</td>
            </tr>
            <tr>
              <th>doc</th>
              <td>検索結果の要素。</td>
            </tr>
            <tr>
              <th>site</th>
              <td>サイト名。</td>
            </tr>
            <tr>
              <th>content-description</th>
              <td>コンテンツの説明。</td>
            </tr>
            <tr>
              <th>host</th>
              <td>ホスト名。</td>
            </tr>
            <tr>
              <th>last-modified</th>
              <td>最終更新日時。</td>
            </tr>
            <tr>
              <th>cache</th>
              <td>コンテンツの内容。</td>
            </tr>
            <tr>
              <th>score</th>
              <td>ドキュメントのスコア値。</td>
            </tr>
            <tr>
              <th>digest</th>
              <td>ドキュメントのダイジェスト文字列。</td>
            </tr>
            <tr>
              <th>created</th>
              <td>ドキュメントの生成日時。</td>
            </tr>
            <tr>
              <th>url</th>
              <td>ドキュメントのURL。</td>
            </tr>
            <tr>
              <th>id</th>
              <td>ドキュメントのID。</td>
            </tr>
            <tr>
              <th>mimetype</th>
              <td>MIMEタイプ。</td>
            </tr>
            <tr>
              <th>title</th>
              <td>ドキュメントのタイトル。</td>
            </tr>
            <tr>
              <th>content-title</th>
              <td>表示用のドキュメントのタイトル。</td>
            </tr>
            <tr>
              <th>content-length</th>
              <td>ドキュメントのサイズ。</td>
            </tr>
            <tr>
              <th>url-link</th>
              <td>検索結果としてのURL。</td>
            </tr>
          </tbody>
        </table>
      </subsection>
    </section>
  </body>
</document>
