<?xml version='1.0' encoding='UTF-8'?>
<document>
  <properties>
    <title>Use of LibreOffice</title>
    <author>Shinsuke Sugaya</author>
  </properties>
  <body><p style="font-weight:bold;color:red;">This page is generated by Machine Translation from Japanese.</p>
    <section name='Use of OpenOffice/LibreOffice'>
      <p>
        It is possible to crawl using the Apache POI Fess environmental standard in MS Office system document.
      You can crawl Office system document regarding LibreOffice, OpenOffice, do even more accurate text extraction from documents.</p>
    </section>
      <section name='How to set up'>
        <p>JodConverter Fess server install. from http://jodconverter.googlecode.com/<a href='http://jodconverter.googlecode.com/files/jodconverter-core-3.0-beta-4-dist.zip'>jodconverter-core-3.0-Beta-4-Dist.zip</a>The download. Expand and copy the jar file to Fess server.</p>
        <source><![CDATA[
$ unzip jodconverter-core-3.0-beta-4-dist.zip 
$ cp jodconverter-core-3.0-beta-4/lib/juh-3.2.1.jar \
jodconverter-core-3.0-beta-4/lib/jurt-3.2.1.jar \
jodconverter-core-3.0-beta-4/lib/ridl-3.2.1.jar \
jodconverter-core-3.0-beta-4/lib/unoil-3.2.1.jar \
jodconverter-core-3.0-beta-4/lib/jodconverter-core-3.0-beta-4.jar \
fess-server-7.0.0/webapps/fess/WEB-INF/cmd/lib/
$ cd fess-server-7.0.0/
]]></source>
        <p>Create a s2robot_extractor.dicon to the next.</p>
        <source><![CDATA[
vi webapps/fess/WEB-INF/classes/s2robot_extractor.dicon 
]]></source>
        <p>s2robot_extractor.dicon effective jodExtractor with following contents.</p>
        <source><![CDATA[
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE components PUBLIC "-//SEASAR//DTD S2Container 2.4//EN"
    "http://www.seasar.org/dtd/components24.dtd">
<components>
    <component name="tikaExtractor" class="org.seasar.robot.extractor.impl.TikaExtractor"/>
    <component name="msWordExtractor"
        class="org.seasar.robot.extractor.impl.MsWordExtractor"/>
    <component name="msExcelExtractor"
        class="org.seasar.robot.extractor.impl.MsExcelExtractor"/>
    <component name="msPowerPointExtractor"
        class="org.seasar.robot.extractor.impl.MsPowerPointExtractor"/>
    <component name="msPublisherExtractor"
        class="org.seasar.robot.extractor.impl.MsPublisherExtractor"/>
    <component name="msVisioExtractor"
        class="org.seasar.robot.extractor.impl.MsVisioExtractor"/>
    <component name="pdfExtractor" class="org.seasar.robot.extractor.impl.PdfExtractor"/>
    <component name="textExtractor" class="org.seasar.robot.extractor.impl.TextExtractor"/>
    <component name="htmlExtractor" class="org.seasar.robot.extractor.impl.HtmlExtractor"/>
    <component name="xmlExtractor" class="org.seasar.robot.extractor.impl.XmlExtractor"/>
    <component name="htmlXpathExtractor"
        class="org.seasar.robot.extractor.impl.HtmlXpathExtractor">
        <initMethod name="addFeature">
            <arg>"http://xml.org/sax/features/namespaces"</arg>
            <arg>"false"</arg>
        </initMethod>
    </component>
    <component name="officeManagerConfiguration"
        class="org.artofsolving.jodconverter.office.DefaultOfficeManagerConfiguration">
    </component>
    <component name="jodExtractor"
        class="org.seasar.robot.extractor.impl.JodExtractor">
        <property name="officeManager">
            officeManagerConfiguration.setOfficeHome("/usr/lib/libreoffice")
                .buildOfficeManager()
        </property>
    </component>
    
    <component name="extractorFactory" class="org.seasar.robot.extractor.ExtractorFactory">
        <initMethod name="addExtractor">
            <arg>{
"application/msword",
"application/vnd.ms-excel",
"application/vnd.ms-powerpoint",
"application/vnd.openxmlformats-officedocument.wordprocessingml.document",
"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",
"application/vnd.openxmlformats-officedocument.presentationml.presentation"
            }</arg>
            <arg>jodExtractor</arg>
        </initMethod>
...
]]></source>
        <p>Index to generate the settings later, usually crawled into the street.</p>
      </section>
  </body>
</document>
